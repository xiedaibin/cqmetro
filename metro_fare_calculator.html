<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è½»è½¨äº¤é€šè´¹ç”¨è®¡ç®—å™¨</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.2em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }
        
        .station-selector {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .line-select {
            flex: 1;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .station-select {
            flex: 2;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .line-select:focus, .station-select:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
        }
        
        button {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            cursor: pointer;
            font-weight: bold;
            margin-top: 10px;
            transform: translateY(0);
            transition: all 0.3s ease;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .result {
            margin-top: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 10px;
            color: white;
            font-size: 18px;
            display: none;
            animation: slideIn 0.5s ease;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .pricing-rule {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }
        
        .pricing-rule h3 {
            margin-top: 0;
            color: #333;
        }
        
        .route-info {
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            color: #333;
        }
        
        .line-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 15px;
            color: white;
            font-size: 12px;
            font-weight: bold;
            margin-right: 5px;
        }
        
        .line-1 { background-color: #e74c3c; }
        .line-2 { background-color: #3498db; }
        
        .selected-station {
            margin-top: 10px;
            padding: 8px 12px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 6px;
            font-size: 14px;
            color: #333;
        }
        
        .line-color-1 { color: #e74c3c; font-weight: bold; }
        .line-color-2 { color: #3498db; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸšŠ è½»è½¨äº¤é€šè´¹ç”¨è®¡ç®—å™¨</h1>
        
        <div class="pricing-rule">
            <h3>ğŸ’° è®¡ä»·è§„åˆ™</h3>
            <p>æŒ‰ä¹˜åé‡Œç¨‹è®¡ä»·ï¼š0-4km: 2å…ƒ | 4-8km: 3å…ƒ | 8-12km: 4å…ƒ | 12-17km: 5å…ƒ | 17-23km: 6å…ƒ | 23-30km: 7å…ƒ | 30-40km: 8å…ƒ | 40-55km: 9å…ƒ | 55kmä»¥ä¸Šæ¯å¢åŠ 20kmå¢åŠ 1å…ƒ</p>
        </div>
        
        <div class="input-group">
            <label for="startLine">ğŸš‰ èµ·å§‹ç«™ç‚¹ï¼š</label>
            <div class="station-selector">
                <select id="startLine" class="line-select" onchange="updateStationList('start')">
                    <option value="">é€‰æ‹©çº¿è·¯</option>
                    <option value="1">1å·çº¿</option>
                    <option value="2">2å·çº¿</option>
                </select>
                <select id="startStation" class="station-select" disabled>
                    <option value="">è¯·å…ˆé€‰æ‹©çº¿è·¯</option>
                </select>
            </div>
            <div id="startSelected" class="selected-station" style="display: none;"></div>
        </div>
        
        <div class="input-group">
            <label for="endLine">ğŸ¯ ç›®çš„ç«™ç‚¹ï¼š</label>
            <div class="station-selector">
                <select id="endLine" class="line-select" onchange="updateStationList('end')">
                    <option value="">é€‰æ‹©çº¿è·¯</option>
                    <option value="1">1å·çº¿</option>
                    <option value="2">2å·çº¿</option>
                </select>
                <select id="endStation" class="station-select" disabled>
                    <option value="">è¯·å…ˆé€‰æ‹©çº¿è·¯</option>
                </select>
            </div>
            <div id="endSelected" class="selected-station" style="display: none;"></div>
        </div>
        
        <button onclick="calculateFare()">ğŸ” è®¡ç®—è´¹ç”¨</button>
        
        <div id="result" class="result"></div>
    </div>

    <script>
        // 1å·çº¿ç«™ç‚¹åˆ—è¡¨
        const line1Stations = [
            "æœå¤©é—¨", "å°ä»€å­—", "è¾ƒåœºå£", "ä¸ƒæ˜Ÿå²—", "ä¸¤è·¯å£", "è·‘å²­", "å¤§åª", "çŸ³æ²¹è·¯", 
            "æ­‡å°å­", "çŸ³æ¡¥é“º", "é«˜åº™æ‘", "é©¬å®¶å²©", "å°é¾™å", "æ²™åªå", "æ¨å…¬æ¡¥", 
            "çƒˆå£«å¢“", "ç£å™¨å£", "çŸ³äº•å¡", "åŒç¢‘", "èµ–å®¶æ¡¥", "å¾®ç”µå›­", "é™ˆå®¶æ¡¥", 
            "å¤§å­¦åŸ", "å°–é¡¶å¡"
        ];

        // 2å·çº¿ç«™ç‚¹åˆ—è¡¨
        const line2Stations = [
            "è¾ƒåœºå£", "ä¸´æ±Ÿé—¨", "é»„èŠ±å›­", "å¤§æºªæ²Ÿ", "æ›¾å®¶å²©", "ç‰›è§’æ²±", "æå­å", 
            "ä½›å›¾å…³", "å¤§åª", "è¢å®¶å²—", "è°¢å®¶æ¹¾", "æ¨å®¶åª", "åŠ¨ç‰©å›­", "å¤§å °æ‘", 
            "é©¬ç‹åœº", "å¹³å®‰", "å¤§æ¸¡å£", "æ–°å±±æ‘", "å¤©å ‚å ¡", "å»ºæ¡¥", "é‡‘å®¶æ¹¾", 
            "åˆ˜å®¶å", "ç™½å±…å¯º", "å¤§æ±Ÿ", "é±¼æ´"
        ];

        // 1å·çº¿è·ç¦»æ•°æ®
        const line1Distances = {
            "æœå¤©é—¨": {"å°ä»€å­—": 0.654, "è¾ƒåœºå£": 2.018, "ä¸ƒæ˜Ÿå²—": 2.873, "ä¸¤è·¯å£": 4.297, "è·‘å²­": 5.897, "å¤§åª": 7.640, "çŸ³æ²¹è·¯": 8.786, "æ­‡å°å­": 9.860, "çŸ³æ¡¥é“º": 11.164, "é«˜åº™æ‘": 12.751, "é©¬å®¶å²©": 13.934, "å°é¾™å": 15.019, "æ²™åªå": 15.893, "æ¨å…¬æ¡¥": 17.031, "çƒˆå£«å¢“": 17.895, "ç£å™¨å£": 18.919, "çŸ³äº•å¡": 20.354, "åŒç¢‘": 22.264, "èµ–å®¶æ¡¥": 29.168, "å¾®ç”µå›­": 30.967, "é™ˆå®¶æ¡¥": 34.329, "å¤§å­¦åŸ": 36.221, "å°–é¡¶å¡": 37.762},
            "å°ä»€å­—": {"æœå¤©é—¨": 0.654, "è¾ƒåœºå£": 1.361, "ä¸ƒæ˜Ÿå²—": 2.219, "ä¸¤è·¯å£": 3.643, "è·‘å²­": 5.243, "å¤§åª": 6.986, "çŸ³æ²¹è·¯": 8.132, "æ­‡å°å­": 9.206, "çŸ³æ¡¥é“º": 10.510, "é«˜åº™æ‘": 12.097, "é©¬å®¶å²©": 13.280, "å°é¾™å": 14.365, "æ²™åªå": 15.239, "æ¨å…¬æ¡¥": 16.377, "çƒˆå£«å¢“": 17.241, "ç£å™¨å£": 18.265, "çŸ³äº•å¡": 19.700, "åŒç¢‘": 21.610, "èµ–å®¶æ¡¥": 28.514, "å¾®ç”µå›­": 30.313, "é™ˆå®¶æ¡¥": 33.675, "å¤§å­¦åŸ": 35.567, "å°–é¡¶å¡": 37.108},
            "è¾ƒåœºå£": {"æœå¤©é—¨": 2.018, "å°ä»€å­—": 1.361, "ä¸ƒæ˜Ÿå²—": 0.858, "ä¸¤è·¯å£": 2.282, "è·‘å²­": 3.882, "å¤§åª": 5.625, "çŸ³æ²¹è·¯": 6.771, "æ­‡å°å­": 7.845, "çŸ³æ¡¥é“º": 9.149, "é«˜åº™æ‘": 10.736, "é©¬å®¶å²©": 11.919, "å°é¾™å": 13.004, "æ²™åªå": 13.878, "æ¨å…¬æ¡¥": 15.016, "çƒˆå£«å¢“": 15.880, "ç£å™¨å£": 16.904, "çŸ³äº•å¡": 18.339, "åŒç¢‘": 20.249, "èµ–å®¶æ¡¥": 27.153, "å¾®ç”µå›­": 28.952, "é™ˆå®¶æ¡¥": 32.314, "å¤§å­¦åŸ": 34.206, "å°–é¡¶å¡": 35.747},
            "ä¸ƒæ˜Ÿå²—": {"æœå¤©é—¨": 2.873, "å°ä»€å­—": 2.219, "è¾ƒåœºå£": 0.858, "ä¸¤è·¯å£": 1.424, "è·‘å²­": 3.024, "å¤§åª": 4.767, "çŸ³æ²¹è·¯": 5.913, "æ­‡å°å­": 6.987, "çŸ³æ¡¥é“º": 8.291, "é«˜åº™æ‘": 9.878, "é©¬å®¶å²©": 11.061, "å°é¾™å": 12.146, "æ²™åªå": 13.020, "æ¨å…¬æ¡¥": 14.158, "çƒˆå£«å¢“": 15.022, "ç£å™¨å£": 16.046, "çŸ³äº•å¡": 17.481, "åŒç¢‘": 19.391, "èµ–å®¶æ¡¥": 26.295, "å¾®ç”µå›­": 28.094, "é™ˆå®¶æ¡¥": 31.456, "å¤§å­¦åŸ": 33.348, "å°–é¡¶å¡": 34.889},
            "ä¸¤è·¯å£": {"æœå¤©é—¨": 4.297, "å°ä»€å­—": 3.643, "è¾ƒåœºå£": 2.282, "ä¸ƒæ˜Ÿå²—": 1.424, "è·‘å²­": 1.600, "å¤§åª": 3.343, "çŸ³æ²¹è·¯": 4.489, "æ­‡å°å­": 5.563, "çŸ³æ¡¥é“º": 6.867, "é«˜åº™æ‘": 8.454, "é©¬å®¶å²©": 9.637, "å°é¾™å": 10.722, "æ²™åªå": 11.596, "æ¨å…¬æ¡¥": 12.734, "çƒˆå£«å¢“": 13.598, "ç£å™¨å£": 14.622, "çŸ³äº•å¡": 16.057, "åŒç¢‘": 17.967, "èµ–å®¶æ¡¥": 24.871, "å¾®ç”µå›­": 26.670, "é™ˆå®¶æ¡¥": 30.032, "å¤§å­¦åŸ": 31.924, "å°–é¡¶å¡": 33.465},
            "è·‘å²­": {"æœå¤©é—¨": 5.897, "å°ä»€å­—": 5.243, "è¾ƒåœºå£": 3.882, "ä¸ƒæ˜Ÿå²—": 3.024, "ä¸¤è·¯å£": 1.600, "å¤§åª": 1.743, "çŸ³æ²¹è·¯": 2.889, "æ­‡å°å­": 3.963, "çŸ³æ¡¥é“º": 5.267, "é«˜åº™æ‘": 6.854, "é©¬å®¶å²©": 8.037, "å°é¾™å": 9.122, "æ²™åªå": 9.996, "æ¨å…¬æ¡¥": 11.134, "çƒˆå£«å¢“": 11.998, "ç£å™¨å£": 13.022, "çŸ³äº•å¡": 14.457, "åŒç¢‘": 16.367, "èµ–å®¶æ¡¥": 23.271, "å¾®ç”µå›­": 25.070, "é™ˆå®¶æ¡¥": 28.432, "å¤§å­¦åŸ": 30.324, "å°–é¡¶å¡": 31.865},
            "å¤§åª": {"æœå¤©é—¨": 7.640, "å°ä»€å­—": 6.986, "è¾ƒåœºå£": 5.625, "ä¸ƒæ˜Ÿå²—": 4.767, "ä¸¤è·¯å£": 3.343, "è·‘å²­": 1.743, "çŸ³æ²¹è·¯": 1.146, "æ­‡å°å­": 2.220, "çŸ³æ¡¥é“º": 3.524, "é«˜åº™æ‘": 5.111, "é©¬å®¶å²©": 6.294, "å°é¾™å": 7.379, "æ²™åªå": 8.253, "æ¨å…¬æ¡¥": 9.391, "çƒˆå£«å¢“": 10.255, "ç£å™¨å£": 11.279, "çŸ³äº•å¡": 12.714, "åŒç¢‘": 14.624, "èµ–å®¶æ¡¥": 21.528, "å¾®ç”µå›­": 23.327, "é™ˆå®¶æ¡¥": 26.689, "å¤§å­¦åŸ": 28.581, "å°–é¡¶å¡": 30.122}
        };

        // 2å·çº¿è·ç¦»æ•°æ®
        const line2Distances = {
            "è¾ƒåœºå£": {"ä¸´æ±Ÿé—¨": 0.579, "é»„èŠ±å›­": 1.745, "å¤§æºªæ²Ÿ": 2.441, "æ›¾å®¶å²©": 3.261, "ç‰›è§’æ²±": 4.299, "æå­å": 5.290, "ä½›å›¾å…³": 6.106, "å¤§åª": 7.652, "è¢å®¶å²—": 9.178, "è°¢å®¶æ¹¾": 10.392, "æ¨å®¶åª": 11.714, "åŠ¨ç‰©å›­": 12.708, "å¤§å °æ‘": 13.754, "é©¬ç‹åœº": 14.901, "å¹³å®‰": 15.950, "å¤§æ¸¡å£": 17.080, "æ–°å±±æ‘": 18.242, "å¤©å ‚å ¡": 19.020, "å»ºæ¡¥": 20.912, "é‡‘å®¶æ¹¾": 22.242, "åˆ˜å®¶å": 23.597, "ç™½å±…å¯º": 25.302, "å¤§æ±Ÿ": 29.001, "é±¼æ´": 30.183},
            "ä¸´æ±Ÿé—¨": {"è¾ƒåœºå£": 0.579, "é»„èŠ±å›­": 1.166, "å¤§æºªæ²Ÿ": 1.862, "æ›¾å®¶å²©": 2.682, "ç‰›è§’æ²±": 3.720, "æå­å": 4.711, "ä½›å›¾å…³": 5.527, "å¤§åª": 7.073, "è¢å®¶å²—": 8.599, "è°¢å®¶æ¹¾": 9.813, "æ¨å®¶åª": 11.135, "åŠ¨ç‰©å›­": 12.129, "å¤§å °æ‘": 13.175, "é©¬ç‹åœº": 14.322, "å¹³å®‰": 15.371, "å¤§æ¸¡å£": 16.501, "æ–°å±±æ‘": 17.663, "å¤©å ‚å ¡": 18.441, "å»ºæ¡¥": 20.333, "é‡‘å®¶æ¹¾": 21.663, "åˆ˜å®¶å": 23.018, "ç™½å±…å¯º": 24.723, "å¤§æ±Ÿ": 28.422, "é±¼æ´": 29.604},
            "å¤§åª": {"è¾ƒåœºå£": 7.652, "ä¸´æ±Ÿé—¨": 7.073, "é»„èŠ±å›­": 5.907, "å¤§æºªæ²Ÿ": 5.211, "æ›¾å®¶å²©": 4.391, "ç‰›è§’æ²±": 3.353, "æå­å": 2.362, "ä½›å›¾å…³": 1.546, "è¢å®¶å²—": 1.526, "è°¢å®¶æ¹¾": 2.740, "æ¨å®¶åª": 4.062, "åŠ¨ç‰©å›­": 5.056, "å¤§å °æ‘": 6.102, "é©¬ç‹åœº": 7.249, "å¹³å®‰": 8.298, "å¤§æ¸¡å£": 9.428, "æ–°å±±æ‘": 10.590, "å¤©å ‚å ¡": 11.368, "å»ºæ¡¥": 13.260, "é‡‘å®¶æ¹¾": 14.590, "åˆ˜å®¶å": 15.945, "ç™½å±…å¯º": 17.650, "å¤§æ±Ÿ": 21.349, "é±¼æ´": 22.531}
        };

        // å½“å‰é€‰æ‹©çš„ç«™ç‚¹ä¿¡æ¯
        let selectedStations = {
            start: { line: null, station: null },
            end: { line: null, station: null }
        };

        // æ›´æ–°ç«™ç‚¹åˆ—è¡¨
        function updateStationList(type) {
            const lineSelect = document.getElementById(type + 'Line');
            const stationSelect = document.getElementById(type + 'Station');
            const selectedDiv = document.getElementById(type + 'Selected');
            const selectedLine = lineSelect.value;

            if (!selectedLine) {
                stationSelect.innerHTML = '<option value="">è¯·å…ˆé€‰æ‹©çº¿è·¯</option>';
                stationSelect.disabled = true;
                selectedDiv.style.display = 'none';
                selectedStations[type] = { line: null, station: null };
                return;
            }

            // æ¸…ç©ºå¹¶å¯ç”¨ç«™ç‚¹é€‰æ‹©
            stationSelect.innerHTML = '<option value="">è¯·é€‰æ‹©ç«™ç‚¹</option>';
            stationSelect.disabled = false;

            // æ ¹æ®çº¿è·¯å¡«å……ç«™ç‚¹
            const stations = selectedLine === '1' ? line1Stations : line2Stations;
            stations.forEach(station => {
                const option = new Option(station, station);
                stationSelect.add(option);
            });

            // æ›´æ–°é€‰æ‹©ä¿¡æ¯
            selectedStations[type].line = selectedLine;
            selectedStations[type].station = null;
            updateSelectedDisplay(type);
        }

        // æ›´æ–°é€‰æ‹©æ˜¾ç¤º
        function updateSelectedDisplay(type) {
            const selectedDiv = document.getElementById(type + 'Selected');
            const selection = selectedStations[type];
            
            if (selection.line && selection.station) {
                const lineClass = selection.line === '1' ? 'line-color-1' : 'line-color-2';
                selectedDiv.innerHTML = `å·²é€‰æ‹©ï¼š<span class="${lineClass}">${selection.line}å·çº¿</span> - ${selection.station}`;
                selectedDiv.style.display = 'block';
            } else if (selection.line) {
                const lineClass = selection.line === '1' ? 'line-color-1' : 'line-color-2';
                selectedDiv.innerHTML = `å·²é€‰æ‹©çº¿è·¯ï¼š<span class="${lineClass}">${selection.line}å·çº¿</span>`;
                selectedDiv.style.display = 'block';
            } else {
                selectedDiv.style.display = 'none';
            }
        }

        // ç«™ç‚¹é€‰æ‹©æ”¹å˜äº‹ä»¶
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('startStation').addEventListener('change', function() {
                selectedStations.start.station = this.value;
                updateSelectedDisplay('start');
            });
            
            document.getElementById('endStation').addEventListener('change', function() {
                selectedStations.end.station = this.value;
                updateSelectedDisplay('end');
            });
        });

        // æ ¹æ®é‡Œç¨‹è®¡ç®—è´¹ç”¨
        function calculatePrice(distance) {
            if (distance <= 4) return 2;
            if (distance <= 8) return 3;
            if (distance <= 12) return 4;
            if (distance <= 17) return 5;
            if (distance <= 23) return 6;
            if (distance <= 30) return 7;
            if (distance <= 40) return 8;
            if (distance <= 55) return 9;
            
            // 55å…¬é‡Œä»¥ä¸Šï¼Œæ¯å¢åŠ 20å…¬é‡Œå¢åŠ 1å…ƒ
            const extraDistance = distance - 55;
            const extraFare = Math.ceil(extraDistance / 20);
            return 9 + extraFare;
        }

        // è·å–ä¸¤ç«™ä¹‹é—´çš„è·ç¦»
        function getDistance(start, end, line) {
            const distances = line === '1' ? line1Distances : line2Distances;
            return distances[start] && distances[start][end] ? distances[start][end] : null;
        }

        // æŸ¥æ‰¾æœ€çŸ­è·¯å¾„
        function findShortestPath(startInfo, endInfo) {
            const { line: startLine, station: startStation } = startInfo;
            const { line: endLine, station: endStation } = endInfo;

            if (startStation === endStation) {
                return { distance: 0, route: [startStation], lines: [], price: 2 };
            }

            // åŒä¸€æ¡çº¿è·¯
            if (startLine === endLine) {
                const distance = getDistance(startStation, endStation, startLine);
                if (distance) {
                    return {
                        distance: distance,
                        route: [startStation, endStation],
                        lines: [startLine],
                        transferStations: [],
                        price: calculatePrice(distance)
                    };
                }
            }

            // éœ€è¦æ¢ä¹˜
            const transferStations = ["è¾ƒåœºå£", "å¤§åª"];
            let shortestDistance = Infinity;
            let bestRoute = null;

            for (let transfer of transferStations) {
                if (transfer === startStation || transfer === endStation) continue;

                const dist1 = getDistance(startStation, transfer, startLine);
                const dist2 = getDistance(transfer, endStation, endLine);

                if (dist1 && dist2) {
                    const totalDistance = dist1 + dist2;
                    if (totalDistance < shortestDistance) {
                        shortestDistance = totalDistance;
                        bestRoute = {
                            distance: totalDistance,
                            route: [startStation, transfer, endStation],
                            lines: [startLine, endLine],
                            transferStations: [transfer],
                            price: calculatePrice(totalDistance)
                        };
                    }
                }
            }

            return bestRoute;
        }

        // è®¡ç®—è´¹ç”¨ä¸»å‡½æ•°
        function calculateFare() {
            const startInfo = selectedStations.start;
            const endInfo = selectedStations.end;
            const resultDiv = document.getElementById('result');

            if (!startInfo.station || !endInfo.station) {
                alert('è¯·å®Œæ•´é€‰æ‹©èµ·å§‹ç«™ç‚¹å’Œç›®çš„ç«™ç‚¹ï¼');
                return;
            }

            if (startInfo.station === endInfo.station) {
                resultDiv.innerHTML = `
                    <h3>ğŸš« èµ·ç‚¹å’Œç»ˆç‚¹ç›¸åŒ</h3>
                    <p>è¯·é€‰æ‹©ä¸åŒçš„èµ·å§‹ç«™ç‚¹å’Œç›®çš„ç«™ç‚¹ã€‚</p>
                `;
                resultDiv.style.display = 'block';
                return;
            }

            const result = findShortestPath(startInfo, endInfo);
            
            if (!result) {
                resultDiv.innerHTML = `
                    <h3>âŒ æ— æ³•æ‰¾åˆ°è·¯å¾„</h3>
                    <p>ä» <strong>${startInfo.station}</strong> åˆ° <strong>${endInfo.station}</strong> æš‚æ— å¯è¾¾è·¯å¾„ã€‚</p>
                `;
                resultDiv.style.display = 'block';
                return;
            }

            let routeInfo = '';
            if (result.transferStations.length > 0) {
                routeInfo = `
                    <div class="route-info">
                        <h4>ğŸ”„ æ¢ä¹˜è·¯çº¿</h4>
                        <p><strong>è·¯å¾„ï¼š</strong>${result.route.join(' â†’ ')}</p>
                        <p><strong>æ¢ä¹˜ç«™ï¼š</strong>${result.transferStations.join(', ')}</p>
                        <p><strong>æ¶‰åŠçº¿è·¯ï¼š</strong>
                            <span class="line-badge line-${result.lines[0]}">${result.lines[0]}å·çº¿</span>
                            <span class="line-badge line-${result.lines[1]}">${result.lines[1]}å·çº¿</span>
                        </p>
                    </div>
                `;
            } else {
                const lineClass = result.lines[0] === '1' ? 'line-1' : 'line-2';
                routeInfo = `
                    <div class="route-info">
                        <h4>ğŸš‡ ç›´è¾¾è·¯çº¿</h4>
                        <p><strong>çº¿è·¯ï¼š</strong><span class="line-badge ${lineClass}">${result.lines[0]}å·çº¿</span></p>
                        <p><strong>è·¯å¾„ï¼š</strong>${result.route.join(' â†’ ')}</p>
                    </div>
                `;
            }

            resultDiv.innerHTML = `
                <h3>ğŸ’° è´¹ç”¨è®¡ç®—ç»“æœ</h3>
                <div style="display: flex; justify-content: space-between; align-items: center; margin: 20px 0;">
                    <div style="font-size: 24px; font-weight: bold;">
                        ç¥¨ä»·ï¼š<span style="color: #fff; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">${result.price}å…ƒ</span>
                    </div>
                    <div style="font-size: 18px;">
                        è·ç¦»ï¼š<span style="color: #fff;">${result.distance.toFixed(2)}å…¬é‡Œ</span>
                    </div>
                </div>
                ${routeInfo}
                <div style="margin-top: 15px; padding: 10px; background: rgba(255,255,255,0.2); border-radius: 5px; font-size: 14px;">
                    <strong>ä»</strong> ${startInfo.station} <strong>åˆ°</strong> ${endInfo.station}
                </div>
            `;
            resultDiv.style.display = 'block';
        }
    </script>
</body>
</html>